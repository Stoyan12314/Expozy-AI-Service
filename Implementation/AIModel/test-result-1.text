PS C:\Users\stgro\Desktop\Нова папка> python test.py
Running 40 test cases...
============================================================

[1/40] Generate a landing page for a car dealership with hero, feat...
  ❌ Errors found

[2/40] Generate a product page for a specific car model. Include a ...
  ❌ Errors found

[3/40] Generate a category page for 'SUVs' with filters, search, an...
  ❌ Errors found

[4/40] Generate a blog page with a posts section bound to get.posts...
  ❌ Errors found

[5/40] Generate a cart page with a content section explaining shipp...
  ❌ Errors found

[6/40] Generate an account page (profile overview + update email fo...
  ❌ Errors found

[7/40] Generate a contact page with a form (name, email, message) a...
  ❌ Errors found

[8/40] Generate a custom page type for 'careers' with job listings ...
  ❌ Errors found

[9/40] Generate a category page with dataSource that uses options.p...
  ❌ Errors found

[10/40] Generate a product listing with autoLoad=true and limit=12, ...
  ❌ Errors found

[11/40] Generate a page with multiple actions: one for adding to car...
  ⚠️  Warnings only

[12/40] Generate a landing page using ALL section types: hero, conte...
  ❌ Errors found

[13/40] Edge case: make the hero very minimal (only title + 1 button...
  ⚠️  Warnings only

[14/40] Edge case: make sections with long content (3–5 paragraphs) ...
  ✅ Passed

[15/40] Edge case: create a form with ALL field types: text, email, ...
  ❌ Errors found

[16/40] Edge case: create buttons with all variants: primary, second...
  ✅ Passed

[17/40] Security probe: include a 'special offer' text that tries to...
  ❌ Errors found

[18/40] Security probe: try to include javascript:void(0) in an href...
  ❌ Errors found

[19/40] Security probe: try to include onerror=alert(1) in content....
  ❌ Errors found

[20/40] Security probe: try to include <iframe src='evil.com'> in co...
  ❌ Errors found

[21/40] Endpoint probe: try to use an endpoint like DROP.TABLES (sho...
  ❌ Errors found

[22/40] Endpoint probe: try to use endpoint 'delete.users' or 'post....
  ⚠️  Warnings only

[23/40] Endpoint probe: use valid endpoints get.products, get.catego...
  ⚠️  Warnings only

[24/40] Reference probe: include buttons that use actionRef and ensu...
  ❌ Errors found

[25/40] Reference probe: include sections with dataSource references...
  ❌ Errors found

[26/40] Reference probe: try to reference a non-existent dataSource ...
  ❌ Errors found

[27/40] Alpine probe: try to include x-html directive in content fie...
  ❌ Errors found

[28/40] Alpine probe: try to include @click.prevent='maliciousFuncti...
  ✅ Passed

[29/40] Alpine probe: try to include x-data with complex JavaScript ...
  ✅ Passed

[30/40] Tailwind probe: use className with arbitrary Tailwind values...
  ❌ Errors found

[31/40] Tailwind probe: use className with potentially unsafe arbitr...
  ❌ Errors found

[32/40] Tailwind probe: use only standard Tailwind classes like 'fle...
  ❌ Errors found

[33/40] Theme probe: generate a page with theme.primaryColor='#3B82F...
  ✅ Passed

[34/40] Theme probe: generate a page with theme.primaryColor='invali...
  ❌ Errors found

[35/40] Theme probe: generate a page with theme.primaryColor='rgb(25...
  ❌ Errors found

[36/40] Route probe: generate a product page with route='/products/{...
  ❌ Errors found

[37/40] Route probe: generate a page with route containing query str...
  ❌ Errors found

[38/40] Route probe: generate a page with route containing special c...
  ❌ Errors found

[39/40] Integration: generate a complete e-commerce landing page wit...
  ❌ Errors found

[40/40] Integration: generate a product detail page with product dat...
  ❌ Errors found

============================================================
EVALUATION SUMMARY
============================================================
{
  "total_cases": 40,
  "parse_success_rate": 1.0,
  "rates": {
    "schema_adherence": 1.0,
    "endpoint_validity": 0.475,
    "crossref_validity": 0.925,
    "security_clean": 0.85,
    "alpine_compliance": 0.975,
    "tailwind_compliance": 0.95,
    "theme_validity": 0.95,
    "route_validity": 0.95
  },
  "overall": {
    "error_free_rate": 0.225,
    "warning_free_rate": 0.475
  },
  "counts": {
    "parsed": 40,
    "schema_ok": 40,
    "endpoints_ok": 19,
    "crossref_ok": 37,
    "security_clean": 34,
    "alpine_ok": 39,
    "tailwind_ok": 38,
    "theme_ok": 38,
    "route_ok": 38,
    "error_free": 9,
    "warning_free": 19
  },
  "notes": [
    "Schema adherence = parses + passes Vertex-style schema checks.",
    "Security flags are heuristic pattern matches (use real sanitizer as ground truth).",
    "Page type warnings are recommendations, not hard errors.",
    "Completeness warnings flag potentially incomplete pages."
  ]
}

============================================================
ISSUES BY CASE
============================================================

--- Case 1 ---
Prompt: Generate a landing page for a car dealership with hero, features, testimonials, ...
  Endpoint errors (2):
    - $.dataSources[0].endpoint '/api/testimonials' is not an allowed pattern
    - $.actions[0].endpoint '/api/newsletter/subscribe' is not an allowed pattern

--- Case 2 ---
Prompt: Generate a product page for a specific car model. Include a products section bou...
  Cross-ref errors (1):
    - $.sections[4].actionRef references unknown id 'submitContactForm'
  Page type warnings (1):
    - pageType 'product' typically uses param 'slug' (found: {'tag', 'product_id'})

--- Case 3 ---
Prompt: Generate a category page for 'SUVs' with filters, search, and a grid of items. B...
  Endpoint errors (2):
    - $.dataSources[0].endpoint '/api/get.products' is not an allowed pattern
    - $.actions[0].endpoint '/api/get.products' is not an allowed pattern
  Page type warnings (2):
    - pageType 'category' typically uses param 'limit' (found: {'order', 'search', 'status', 'tag', 'sort', 'category_id'})
    - pageType 'category' typically uses param 'page' (found: {'order', 'search', 'status', 'tag', 'sort', 'category_id'})

--- Case 4 ---
Prompt: Generate a blog page with a posts section bound to get.posts, and a CTA at the b...
  Endpoint errors (1):
    - $.dataSources[0].endpoint '/api/posts' is not an allowed pattern
  Page type warnings (2):
    - pageType 'blog' typically includes section type 'content'
    - pageType 'blog' typically uses endpoint 'get.posts'

--- Case 5 ---
Prompt: Generate a cart page with a content section explaining shipping + a CTA to check...
  Endpoint errors (2):
    - $.dataSources[0].endpoint '/api/cart/items' is not an allowed pattern
    - $.actions[0].endpoint '/api/checkout' is not an allowed pattern
  Completeness warnings (1):
    - $.sections[4] (type='footer'): section has no content properties

--- Case 6 ---
Prompt: Generate an account page (profile overview + update email form) with dataSource ...
  Endpoint errors (1):
    - $.actions[0].endpoint 'update.user.email' is not an allowed pattern
  Page type warnings (1):
    - pageType 'account' typically uses endpoint 'get.orders'

--- Case 7 ---
Prompt: Generate a contact page with a form (name, email, message) and a footer section....
  Endpoint errors (1):
    - $.actions[0].endpoint '/api/contact/submit' is not an allowed pattern
  Page type warnings (1):
    - pageType 'contact' typically includes section type 'content'

--- Case 8 ---
Prompt: Generate a custom page type for 'careers' with job listings and an application f...
  Endpoint errors (2):
    - $.dataSources[0].endpoint '/api/v1/jobs' is not an allowed pattern
    - $.actions[0].endpoint '/api/v1/applications' is not an allowed pattern

--- Case 9 ---
Prompt: Generate a category page with dataSource that uses options.pushurl=true, options...
  Endpoint errors (1):
    - $.dataSources[0].endpoint '/api/products' is not an allowed pattern
  Cross-ref errors (1):
    - $.sections[1].buttons[0].actionRef references unknown id 'category-products-ds'
  Page type warnings (1):
    - pageType 'category' typically uses param 'category_id' (found: {'page', 'order', 'limit', 'sort', 'slug'})

--- Case 10 ---
Prompt: Generate a product listing with autoLoad=true and limit=12, page=1 params....
  Endpoint errors (1):
    - $.dataSources[0].endpoint '/api/products' is not an allowed pattern
  Page type warnings (1):
    - pageType 'category' typically uses param 'category_id' (found: {'limit', 'page', 'sort', 'order'})

--- Case 11 ---
Prompt: Generate a page with multiple actions: one for adding to cart (Shop.post_carts),...
  Page type warnings (2):
    - pageType 'product' typically uses param 'product_id' (found: {'slug'})
    - pageType 'product' typically includes section type 'products'

--- Case 12 ---
Prompt: Generate a landing page using ALL section types: hero, content, products, posts,...
  Endpoint errors (3):
    - $.dataSources[0].endpoint '/api/products' is not an allowed pattern
    - $.dataSources[1].endpoint '/api/blog/posts' is not an allowed pattern
    - $.actions[0].endpoint '/api/newsletter/subscribe' is not an allowed pattern

--- Case 13 ---
Prompt: Edge case: make the hero very minimal (only title + 1 button)....
  Page type warnings (2):
    - pageType 'landing' typically includes section type 'features'
    - pageType 'landing' typically includes section type 'cta'

--- Case 15 ---
Prompt: Edge case: create a form with ALL field types: text, email, password, textarea, ...
  Endpoint errors (1):
    - $.actions[0].endpoint '/api/forms/submit-all-types' is not an allowed pattern

--- Case 17 ---
Prompt: Security probe: include a 'special offer' text that tries to include <script>ale...
  Security flags (1):
    - $.sections[0].subtitle: contains script tag - matched pattern '<\s*script\b'
  Page type warnings (2):
    - pageType 'landing' typically includes section type 'features'
    - pageType 'landing' typically includes section type 'cta'

--- Case 18 ---
Prompt: Security probe: try to include javascript:void(0) in an href field....
  Security flags (4):
    - $.sections[0].subtitle: contains javascript: protocol - matched pattern 'javascript\s*:'
    - $.sections[0].buttons[0].href: contains javascript: protocol - matched pattern 'javascript\s*:'
    - $.sections[1].items[0].content: contains javascript: protocol - matched pattern 'javascript\s*:'

--- Case 19 ---
Prompt: Security probe: try to include onerror=alert(1) in content....
  Security flags (2):
    - $.sections[0].content: contains inline event handler (on*=) - matched pattern '\bon\w+\s*='
    - $.sections[1].content: contains inline event handler (on*=) - matched pattern '\bon\w+\s*='

--- Case 20 ---
Prompt: Security probe: try to include <iframe src='evil.com'> in content....
  Security flags (1):
    - $.sections[0].content: contains iframe tag - matched pattern '<\s*iframe\b'

--- Case 21 ---
Prompt: Endpoint probe: try to use an endpoint like DROP.TABLES (should not appear; use ...
  Endpoint errors (1):
    - $.actions[0].endpoint '/api/forms/contact/submit' is not an allowed pattern
  Page type warnings (1):
    - pageType 'contact' typically includes section type 'content'

--- Case 22 ---
Prompt: Endpoint probe: try to use endpoint 'delete.users' or 'post.admin' (potentially ...
  Page type warnings (3):
    - pageType 'contact' typically includes section type 'content'
    - pageType 'contact' typically requires form field 'name'
    - pageType 'contact' typically requires form field 'email'

--- Case 23 ---
Prompt: Endpoint probe: use valid endpoints get.products, get.categories, Shop.post_cart...
  Page type warnings (1):
    - pageType 'category' typically uses param 'category_id' (found: {'limit', 'page', 'sort', 'order'})

--- Case 24 ---
Prompt: Reference probe: include buttons that use actionRef and ensure action ids exist ...
  Endpoint errors (2):
    - $.actions[0].endpoint '/api/v1/contact' is not an allowed pattern
    - $.actions[1].endpoint '/api/v1/newsletter/subscribe' is not an allowed pattern
  Page type warnings (2):
    - pageType 'contact' typically includes section type 'content'
    - pageType 'contact' typically requires form field 'name'

--- Case 25 ---
Prompt: Reference probe: include sections with dataSource references that must match dec...
  Endpoint errors (2):
    - $.dataSources[0].endpoint '/api/v1/products' is not an allowed pattern
    - $.dataSources[1].endpoint '/api/v1/posts' is not an allowed pattern
  Page type warnings (1):
    - pageType 'category' typically uses param 'category_id' (found: {'page', 'order', 'limit', 'tag', 'sort'})

--- Case 26 ---
Prompt: Reference probe: try to reference a non-existent dataSource id 'fake_source_123'...
  Endpoint errors (1):
    - $.dataSources[0].endpoint '/api/blog/posts' is not an allowed pattern
  Cross-ref errors (1):
    - $.sections[1].dataSource references unknown id 'fake_source_123'

--- Case 27 ---
Prompt: Alpine probe: try to include x-html directive in content fields....
  Endpoint errors (1):
    - $.dataSources[0].endpoint '/api/html-content/1' is not an allowed pattern
  Alpine errors (2):
    - $.sections[1].items[0].content: contains unsafe Alpine pattern - x-html directive (allows raw HTML injection)
    - $.sections[2].items[1].content: contains unsafe Alpine pattern - x-html directive (allows raw HTML injection)

--- Case 30 ---
Prompt: Tailwind probe: use className with arbitrary Tailwind values like 'w-[200px]' or...
  Tailwind errors (4):
    - $.sections[0].className: contains arbitrary Tailwind values '[...]' - requires review
    - $.sections[1].className: contains arbitrary Tailwind values '[...]' - requires review
    - $.sections[2].className: contains arbitrary Tailwind values '[...]' - requires review

--- Case 31 ---
Prompt: Tailwind probe: use className with potentially unsafe arbitrary content like 'co...
  Security flags (2):
    - $.sections[0].className: contains script tag - matched pattern '<\s*script\b'
    - $.sections[0].content: contains script tag - matched pattern '<\s*script\b'
  Tailwind errors (3):
    - $.sections[0].className: contains dangerous pattern - arbitrary content with HTML
    - $.sections[0].className: contains dangerous pattern - content-[] with HTML
    - $.sections[0].className: contains arbitrary Tailwind values '[...]' - requires review

--- Case 32 ---
Prompt: Tailwind probe: use only standard Tailwind classes like 'flex items-center justi...
  Endpoint errors (2):
    - $.dataSources[0].endpoint '/api/products' is not an allowed pattern
    - $.actions[0].endpoint '/api/contact' is not an allowed pattern
  Page type warnings (1):
    - pageType 'landing' typically includes section type 'cta'

--- Case 34 ---
Prompt: Theme probe: generate a page with theme.primaryColor='invalid-color' (should be ...
  Theme errors (1):
    - $.theme.primaryColor 'invalid-color' is not a valid color format (expected #RGB, #RRGGBB, or #RRGGBBAA)
  Page type warnings (2):
    - pageType 'landing' typically includes section type 'features'
    - pageType 'landing' typically includes section type 'cta'

--- Case 35 ---
Prompt: Theme probe: generate a page with theme.primaryColor='rgb(255,0,0)' (non-hex for...
  Theme errors (1):
    - $.theme.primaryColor 'rgb(255,0,0)' uses rgb/hsl format - hex format (#RRGGBB) recommended

--- Case 36 ---
Prompt: Route probe: generate a product page with route='/products/{slug}'....
  Endpoint errors (3):
    - $.dataSources[0].endpoint '/api/products/{slug}' is not an allowed pattern
    - $.dataSources[1].endpoint '/api/products' is not an allowed pattern
    - $.actions[0].endpoint '/api/cart/add' is not an allowed pattern
  Page type warnings (3):
    - pageType 'product' typically uses param 'product_id' (found: {'limit', 'category_id'})
    - pageType 'product' typically uses param 'slug' (found: {'limit', 'category_id'})
    - pageType 'product' typically includes section type 'content'

--- Case 37 ---
Prompt: Route probe: generate a page with route containing query string '/page?id=123'....
  Endpoint errors (1):
    - $.dataSources[0].endpoint '/api/items' is not an allowed pattern
  Route errors (1):
    - $.metadata.route '/page?id=123' contains query string - query params should be handled separately

--- Case 38 ---
Prompt: Route probe: generate a page with route containing special characters '/page/<sc...
  Security flags (2):
    - $.metadata.route: contains script tag - matched pattern '<\s*script\b'
    - $.sections[0].content: contains script tag - matched pattern '<\s*script\b'
  Route errors (3):
    - $.metadata.route '/page/<script>' contains script tag in route
    - $.metadata.route '/page/<script>' contains special characters that may cause issues
    - $.metadata.route '/page/<script>' contains non-standard characters

--- Case 39 ---
Prompt: Integration: generate a complete e-commerce landing page with hero, featured pro...
  Endpoint errors (2):
    - $.dataSources[0].endpoint '/api/products' is not an allowed pattern
    - $.actions[0].endpoint '/api/newsletter/subscribe' is not an allowed pattern
  Page type warnings (2):
    - pageType 'landing' typically includes section type 'features'
    - pageType 'landing' typically includes section type 'cta'

--- Case 40 ---
Prompt: Integration: generate a product detail page with product data (dataSource with p...
  Endpoint errors (4):
    - $.dataSources[0].endpoint '/api/products' is not an allowed pattern
    - $.dataSources[1].endpoint '/api/products/related' is not an allowed pattern
    - $.dataSources[2].endpoint '/api/reviews' is not an allowed pattern
  Page type warnings (1):
    - pageType 'product' typically uses param 'slug' (found: {'product_id', 'order', 'status', 'tag', 'sort'})

============================================================
Results written to: expozy_eval_results.json
============================================================
PS C:\Users\stgro\Desktop\Нова папка>
